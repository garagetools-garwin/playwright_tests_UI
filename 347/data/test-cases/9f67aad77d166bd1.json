{"uid":"9f67aad77d166bd1","name":"Создание заказа с валидацией JSON-схемы","fullName":"tests.test_create_order#test_create_order_schema","historyId":"8ede2a8f9afd0feea1baf558df8c32e3","time":{"start":1749964793998,"stop":1749964912598,"duration":118600},"status":"failed","statusMessage":"Failed: SCHEMA VALIDATION FAILED:\nField: ['summary', 'subtotal']\nError: '400' was expected\nValue: 500","statusTrace":"page_fixture = <Page url='https://garwin.ru/cabinet/purchase/977b3c81-d930-4814-9a7f-2c60e3beec4a'>\nbase_url = 'https://garwin.ru'\ndelete_recipient_fixture = <function delete_recipient_fixture.<locals>.mark_as_created at 0x7f456d3bb6a0>\ndelete_address_fixture = <function delete_address_fixture.<locals>.mark_as_created at 0x7f456d3bbec0>\n\n    @pytest.mark.auth\n    @pytest.mark.smoke\n    @pytest.mark.custom_schedule\n    @allure.title(\"Создание заказа с валидацией JSON-схемы\")\n    def test_create_order_schema(page_fixture, base_url, delete_recipient_fixture, delete_address_fixture):\n        cart_page = CartPage(page_fixture)\n        checkout_page = CheckoutPage(page_fixture)\n        purchase_page = PurchasePage(page_fixture)\n        header = HeaderElement(page_fixture)\n        companies_page = CompaniesPage(page_fixture)\n        companies_page.select_company_with_retail_price(base_url)\n        cart_page.open(base_url)\n    \n        with allure.step(\"Запоминаю адрес в блоке Получение\"):\n            company_name = header.company_name_text()\n    \n        cart_page.clear_cart()\n        cart_page.add_to_cart_cheap_product(base_url)\n    \n        name, email, phone = checkout_page.buyer_and_recipient_block.create_recipient(base_url, page_fixture)\n        checkout_page.obtaining_block.create_address(base_url, page_fixture)\n    \n        delete_recipient_fixture()\n        delete_address_fixture()\n    \n        with allure.step(\"Добавляею комментарий к заказу\"):\n            checkout_page.payment_block.click_contact_a_manager_button()\n            checkout_page.commentary_block.click_commentary_togle_button()\n            checkout_page.commentary_block.fill_commentary_textarea(\"!!! TEST !!!\")\n    \n        with allure.step(\"Запоминаю адрес в блоке Получение\"):\n            obtaining_block_adress = checkout_page.obtaining_block.pickup_point_adress().inner_text()\n    \n        with allure.step(\"Загружаю JSON-схему\"):\n    \n            load_dotenv()\n            json_schema_base64 = os.getenv(\"JSON_SCHEMA\")\n    \n            if json_schema_base64:\n                # Декодируем Base64\n                json_schema_str = base64.b64decode(json_schema_base64).decode(\"utf-8\")\n                # Загружаем в JSON\n                response_schema = json.loads(json_schema_str)\n            else:\n                raise ValueError(\"JSON_SCHEMA is not set\")\n                # print(json.dumps(response_schema, indent=4))\n    \n        with allure.step(\"Перехватываю запрос и ответ\"):\n            with (page_fixture.expect_response(os.getenv(\"METHOD\")) as response_info,\n                  page_fixture.expect_request(os.getenv(\"METHOD\")) as request_info):\n                checkout_page.calculation_block.click_order_button()\n    \n        time.sleep(5)\n        order_number = purchase_page.memorize_the_order_number()\n        print(order_number)\n        with allure.step(\"Проверяю, что номер заказа не пустой\"):\n            assert order_number != \"\", \"Номер заказа пустой!\"\n        with allure.step(\n                \"Проверяю, что номер заказа соответствует одному из шаблонов Х-000000000, ХX000000000, 000000000.\"):\n            pattern = r'^[А-Яа-я-]*\\d{9}[А-Яа-я-]*$'\n    \n            assert re.match(pattern, order_number), f\"Номер заказа '{order_number}' не соответствует шаблону Х-000000000!\"\n    \n        # with allure.step(\"Ожидаю номер заказа\"):\n        #     time.sleep(5)\n        #     order_number = purchase_page.memorize_the_order_number()\n        #     print(order_number)\n    \n        with allure.step(\"Извлекаю из ответа JSON\"):\n            response = response_info.value\n            response_body = response.json()\n    \n        with allure.step(\"Проверяю статус код ответа\"):\n            assert response.status == 200, f\"Ожидался статус 200, получен {response.status}\"\n    \n        with allure.step(\"Валидирую JSON-схему ответа\"):\n            try:\n                validate(instance=response_body, schema=response_schema)\n            except ValidationError as e:\n                pytest.fail(f\"SCHEMA VALIDATION FAILED:\\n\"\n                            f\"Field: {list(e.path)}\\n\"\n                            f\"Error: {e.message}\\n\"\n                            f\"Value: {e.instance}\")\n    \n        # Функция для экранирования кавычек\n        def escape_json_string(value):\n            with allure.step(\"Экранирует кавычки в строках для корректного JSON\"):\n                return json.dumps(value)[1:-1]  # убираем внешние кавычки, но экранируем внутри\n    \n        with allure.step(\"Загружаю JSON-схему с проверочными значениями\"):\n            json_schema_base64_test = os.getenv(\"JSON_SCHEMA_TEST\")\n    \n            if json_schema_base64_test:\n                # Декодируем Base64\n                json_schema_str_test = base64.b64decode(json_schema_base64_test).decode(\"utf-8\")\n                # Загружаем в JSON\n                schema_str = json.loads(json_schema_str_test)\n            else:\n                raise ValueError(\"JSON_SCHEMA_TEST is not set\")\n    \n            # Преобразуем JSON-объект обратно в строку перед replace\n            schema_str = json.dumps(schema_str)\n    \n        with allure.step(\"Заменяю переменные в схеме на реальные значения с экранированием\"):\n            schema_str = schema_str.replace(\"{company_name}\", escape_json_string(company_name))\n            schema_str = schema_str.replace(\"{name}\", escape_json_string(name))\n            schema_str = schema_str.replace(\"{email}\", escape_json_string(email))\n            schema_str = schema_str.replace(\"{phone}\", re.sub(r'\\D', '', phone))\n            with allure.step(\"Заменяю '{obtaining_block_adress}' на JSON-строку\"):\n                obtaining_block_adress_json = json.dumps(obtaining_block_adress)  # превращаем объект в строку JSON\n                schema_str = schema_str.replace(\"\\\"{obtaining_block_adress}\\\"\", obtaining_block_adress_json)\n    \n            with allure.step(\"Преобразую строку обратно в JSON.\"):\n                schema = json.loads(schema_str)\n    \n        def to_lower(obj):\n            \"\"\"Рекурсивно приводит все строки в JSON-объекте к нижнему регистру.\"\"\"\n            if isinstance(obj, dict):\n                return {k: to_lower(v) for k, v in obj.items()}\n            elif isinstance(obj, list):\n                return [to_lower(i) for i in obj]\n            elif isinstance(obj, str):\n                return obj.lower()\n            return obj\n    \n        with allure.step(\"Валидирую JSON-схему ответа\"):\n            try:\n                response_body_lower = to_lower(response_body)\n                schema_lower = to_lower(schema)\n>               validate(instance=response_body_lower, schema=schema_lower)\n\ntests/test_create_order.py:183: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ninstance = {'buyer': {'title': 'ооо \"тест\"'}, 'contact': {'email': 'ershovgerman@example.net', 'id': '4dfc16a1-7620-4bb6-9aa5-35e...ывывывывывывывывывывыывывывывывыываывывывывв\", 'phone': '79483095176'}, 'cost_center': None, 'courier_data': None, ...}\nschema = {'properties': {'buyer': {'properties': {'title': {'const': 'ооо \"тест\"', 'type': 'string'}}, 'required': ['title'], '...'null']}, ...}, 'required': ['id', 'seller', 'buyer', 'contact', 'pickup_data', 'courier_data', ...], 'type': 'object'}\ncls = <class 'jsonschema.validators.Draft202012Validator'>, args = ()\nkwargs = {}\nvalidator = Draft202012Validator(schema={'properties': {'buyer': {'properties': {'title': {'const': 'ооо \"тест\"', 'type': 'string'...red': ['id', 'seller', 'buyer', 'contact', 'pickup_data', 'courier_data', ...], 'type': 'object'}, format_checker=None)\nerror = <ValidationError: \"'400' was expected\">\n\n    def validate(instance, schema, cls=None, *args, **kwargs):  # noqa: D417\n        \"\"\"\n        Validate an instance under the given schema.\n    \n            >>> validate([2, 3, 4], {\"maxItems\": 2})\n            Traceback (most recent call last):\n                ...\n            ValidationError: [2, 3, 4] is too long\n    \n        :func:`~jsonschema.validators.validate` will first verify that the\n        provided schema is itself valid, since not doing so can lead to less\n        obvious error messages and fail in less obvious or consistent ways.\n    \n        If you know you have a valid schema already, especially\n        if you intend to validate multiple instances with\n        the same schema, you likely would prefer using the\n        `jsonschema.protocols.Validator.validate` method directly on a\n        specific validator (e.g. ``Draft202012Validator.validate``).\n    \n    \n        Arguments:\n    \n            instance:\n    \n                The instance to validate\n    \n            schema:\n    \n                The schema to validate with\n    \n            cls (jsonschema.protocols.Validator):\n    \n                The class that will be used to validate the instance.\n    \n        If the ``cls`` argument is not provided, two things will happen\n        in accordance with the specification. First, if the schema has a\n        :kw:`$schema` keyword containing a known meta-schema [#]_ then the\n        proper validator will be used. The specification recommends that\n        all schemas contain :kw:`$schema` properties for this reason. If no\n        :kw:`$schema` property is found, the default validator class is the\n        latest released draft.\n    \n        Any other provided positional and keyword arguments will be passed\n        on when instantiating the ``cls``.\n    \n        Raises:\n    \n            `jsonschema.exceptions.ValidationError`:\n    \n                if the instance is invalid\n    \n            `jsonschema.exceptions.SchemaError`:\n    \n                if the schema itself is invalid\n    \n        .. rubric:: Footnotes\n        .. [#] known by a validator registered with\n            `jsonschema.validators.validates`\n        \"\"\"\n        if cls is None:\n            cls = validator_for(schema)\n    \n        cls.check_schema(schema)\n        validator = cls(schema, *args, **kwargs)\n        error = exceptions.best_match(validator.iter_errors(instance))\n        if error is not None:\n>           raise error\nE           jsonschema.exceptions.ValidationError: '400' was expected\nE           \nE           Failed validating 'const' in schema['properties']['summary']['properties']['subtotal']:\nE               {'const': '400', 'type': 'string'}\nE           \nE           On instance['summary']['subtotal']:\nE               '500'\n\n/opt/hostedtoolcache/Python/3.12.1/x64/lib/python3.12/site-packages/jsonschema/validators.py:1312: ValidationError\n\nDuring handling of the above exception, another exception occurred:\n\npage_fixture = <Page url='https://garwin.ru/cabinet/purchase/977b3c81-d930-4814-9a7f-2c60e3beec4a'>\nbase_url = 'https://garwin.ru'\ndelete_recipient_fixture = <function delete_recipient_fixture.<locals>.mark_as_created at 0x7f456d3bb6a0>\ndelete_address_fixture = <function delete_address_fixture.<locals>.mark_as_created at 0x7f456d3bbec0>\n\n    @pytest.mark.auth\n    @pytest.mark.smoke\n    @pytest.mark.custom_schedule\n    @allure.title(\"Создание заказа с валидацией JSON-схемы\")\n    def test_create_order_schema(page_fixture, base_url, delete_recipient_fixture, delete_address_fixture):\n        cart_page = CartPage(page_fixture)\n        checkout_page = CheckoutPage(page_fixture)\n        purchase_page = PurchasePage(page_fixture)\n        header = HeaderElement(page_fixture)\n        companies_page = CompaniesPage(page_fixture)\n        companies_page.select_company_with_retail_price(base_url)\n        cart_page.open(base_url)\n    \n        with allure.step(\"Запоминаю адрес в блоке Получение\"):\n            company_name = header.company_name_text()\n    \n        cart_page.clear_cart()\n        cart_page.add_to_cart_cheap_product(base_url)\n    \n        name, email, phone = checkout_page.buyer_and_recipient_block.create_recipient(base_url, page_fixture)\n        checkout_page.obtaining_block.create_address(base_url, page_fixture)\n    \n        delete_recipient_fixture()\n        delete_address_fixture()\n    \n        with allure.step(\"Добавляею комментарий к заказу\"):\n            checkout_page.payment_block.click_contact_a_manager_button()\n            checkout_page.commentary_block.click_commentary_togle_button()\n            checkout_page.commentary_block.fill_commentary_textarea(\"!!! TEST !!!\")\n    \n        with allure.step(\"Запоминаю адрес в блоке Получение\"):\n            obtaining_block_adress = checkout_page.obtaining_block.pickup_point_adress().inner_text()\n    \n        with allure.step(\"Загружаю JSON-схему\"):\n    \n            load_dotenv()\n            json_schema_base64 = os.getenv(\"JSON_SCHEMA\")\n    \n            if json_schema_base64:\n                # Декодируем Base64\n                json_schema_str = base64.b64decode(json_schema_base64).decode(\"utf-8\")\n                # Загружаем в JSON\n                response_schema = json.loads(json_schema_str)\n            else:\n                raise ValueError(\"JSON_SCHEMA is not set\")\n                # print(json.dumps(response_schema, indent=4))\n    \n        with allure.step(\"Перехватываю запрос и ответ\"):\n            with (page_fixture.expect_response(os.getenv(\"METHOD\")) as response_info,\n                  page_fixture.expect_request(os.getenv(\"METHOD\")) as request_info):\n                checkout_page.calculation_block.click_order_button()\n    \n        time.sleep(5)\n        order_number = purchase_page.memorize_the_order_number()\n        print(order_number)\n        with allure.step(\"Проверяю, что номер заказа не пустой\"):\n            assert order_number != \"\", \"Номер заказа пустой!\"\n        with allure.step(\n                \"Проверяю, что номер заказа соответствует одному из шаблонов Х-000000000, ХX000000000, 000000000.\"):\n            pattern = r'^[А-Яа-я-]*\\d{9}[А-Яа-я-]*$'\n    \n            assert re.match(pattern, order_number), f\"Номер заказа '{order_number}' не соответствует шаблону Х-000000000!\"\n    \n        # with allure.step(\"Ожидаю номер заказа\"):\n        #     time.sleep(5)\n        #     order_number = purchase_page.memorize_the_order_number()\n        #     print(order_number)\n    \n        with allure.step(\"Извлекаю из ответа JSON\"):\n            response = response_info.value\n            response_body = response.json()\n    \n        with allure.step(\"Проверяю статус код ответа\"):\n            assert response.status == 200, f\"Ожидался статус 200, получен {response.status}\"\n    \n        with allure.step(\"Валидирую JSON-схему ответа\"):\n            try:\n                validate(instance=response_body, schema=response_schema)\n            except ValidationError as e:\n                pytest.fail(f\"SCHEMA VALIDATION FAILED:\\n\"\n                            f\"Field: {list(e.path)}\\n\"\n                            f\"Error: {e.message}\\n\"\n                            f\"Value: {e.instance}\")\n    \n        # Функция для экранирования кавычек\n        def escape_json_string(value):\n            with allure.step(\"Экранирует кавычки в строках для корректного JSON\"):\n                return json.dumps(value)[1:-1]  # убираем внешние кавычки, но экранируем внутри\n    \n        with allure.step(\"Загружаю JSON-схему с проверочными значениями\"):\n            json_schema_base64_test = os.getenv(\"JSON_SCHEMA_TEST\")\n    \n            if json_schema_base64_test:\n                # Декодируем Base64\n                json_schema_str_test = base64.b64decode(json_schema_base64_test).decode(\"utf-8\")\n                # Загружаем в JSON\n                schema_str = json.loads(json_schema_str_test)\n            else:\n                raise ValueError(\"JSON_SCHEMA_TEST is not set\")\n    \n            # Преобразуем JSON-объект обратно в строку перед replace\n            schema_str = json.dumps(schema_str)\n    \n        with allure.step(\"Заменяю переменные в схеме на реальные значения с экранированием\"):\n            schema_str = schema_str.replace(\"{company_name}\", escape_json_string(company_name))\n            schema_str = schema_str.replace(\"{name}\", escape_json_string(name))\n            schema_str = schema_str.replace(\"{email}\", escape_json_string(email))\n            schema_str = schema_str.replace(\"{phone}\", re.sub(r'\\D', '', phone))\n            with allure.step(\"Заменяю '{obtaining_block_adress}' на JSON-строку\"):\n                obtaining_block_adress_json = json.dumps(obtaining_block_adress)  # превращаем объект в строку JSON\n                schema_str = schema_str.replace(\"\\\"{obtaining_block_adress}\\\"\", obtaining_block_adress_json)\n    \n            with allure.step(\"Преобразую строку обратно в JSON.\"):\n                schema = json.loads(schema_str)\n    \n        def to_lower(obj):\n            \"\"\"Рекурсивно приводит все строки в JSON-объекте к нижнему регистру.\"\"\"\n            if isinstance(obj, dict):\n                return {k: to_lower(v) for k, v in obj.items()}\n            elif isinstance(obj, list):\n                return [to_lower(i) for i in obj]\n            elif isinstance(obj, str):\n                return obj.lower()\n            return obj\n    \n        with allure.step(\"Валидирую JSON-схему ответа\"):\n            try:\n                response_body_lower = to_lower(response_body)\n                schema_lower = to_lower(schema)\n                validate(instance=response_body_lower, schema=schema_lower)\n            except ValidationError as e:\n>               pytest.fail(f\"SCHEMA VALIDATION FAILED:\\n\"\n                            f\"Field: {list(e.path)}\\n\"\n                            f\"Error: {e.message}\\n\"\n                            f\"Value: {e.instance}\")\nE               Failed: SCHEMA VALIDATION FAILED:\nE               Field: ['summary', 'subtotal']\nE               Error: '400' was expected\nE               Value: 500\n\ntests/test_create_order.py:185: Failed","flaky":false,"newFailed":true,"newBroken":false,"newPassed":false,"retriesCount":2,"retriesStatusChange":false,"beforeStages":[{"name":"pytestconfig","time":{"start":1749964539395,"stop":1749964539395,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_output_dir","time":{"start":1749964539395,"stop":1749964539395,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_session_faker","time":{"start":1749964539395,"stop":1749964539448,"duration":53},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop_policy","time":{"start":1749964539395,"stop":1749964539395,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"base_url","time":{"start":1749964539448,"stop":1749964539448,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser_type_launch_args","time":{"start":1749964539448,"stop":1749964539448,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_verify_url","time":{"start":1749964539448,"stop":1749964539448,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"playwright","time":{"start":1749964539448,"stop":1749964539677,"duration":229},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser","time":{"start":1749964539677,"stop":1749964541558,"duration":1881},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser_type","time":{"start":1749964539677,"stop":1749964539677,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"launch_browser","time":{"start":1749964539677,"stop":1749964539677,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"page_fixture","time":{"start":1749964793909,"stop":1749964793997,"duration":88},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_recipient_fixture","time":{"start":1749964793997,"stop":1749964793997,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_address_fixture","time":{"start":1749964793997,"stop":1749964793997,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"status":"failed","statusMessage":"Failed: SCHEMA VALIDATION FAILED:\nField: ['summary', 'subtotal']\nError: '400' was expected\nValue: 500","statusTrace":"page_fixture = <Page url='https://garwin.ru/cabinet/purchase/977b3c81-d930-4814-9a7f-2c60e3beec4a'>\nbase_url = 'https://garwin.ru'\ndelete_recipient_fixture = <function delete_recipient_fixture.<locals>.mark_as_created at 0x7f456d3bb6a0>\ndelete_address_fixture = <function delete_address_fixture.<locals>.mark_as_created at 0x7f456d3bbec0>\n\n    @pytest.mark.auth\n    @pytest.mark.smoke\n    @pytest.mark.custom_schedule\n    @allure.title(\"Создание заказа с валидацией JSON-схемы\")\n    def test_create_order_schema(page_fixture, base_url, delete_recipient_fixture, delete_address_fixture):\n        cart_page = CartPage(page_fixture)\n        checkout_page = CheckoutPage(page_fixture)\n        purchase_page = PurchasePage(page_fixture)\n        header = HeaderElement(page_fixture)\n        companies_page = CompaniesPage(page_fixture)\n        companies_page.select_company_with_retail_price(base_url)\n        cart_page.open(base_url)\n    \n        with allure.step(\"Запоминаю адрес в блоке Получение\"):\n            company_name = header.company_name_text()\n    \n        cart_page.clear_cart()\n        cart_page.add_to_cart_cheap_product(base_url)\n    \n        name, email, phone = checkout_page.buyer_and_recipient_block.create_recipient(base_url, page_fixture)\n        checkout_page.obtaining_block.create_address(base_url, page_fixture)\n    \n        delete_recipient_fixture()\n        delete_address_fixture()\n    \n        with allure.step(\"Добавляею комментарий к заказу\"):\n            checkout_page.payment_block.click_contact_a_manager_button()\n            checkout_page.commentary_block.click_commentary_togle_button()\n            checkout_page.commentary_block.fill_commentary_textarea(\"!!! TEST !!!\")\n    \n        with allure.step(\"Запоминаю адрес в блоке Получение\"):\n            obtaining_block_adress = checkout_page.obtaining_block.pickup_point_adress().inner_text()\n    \n        with allure.step(\"Загружаю JSON-схему\"):\n    \n            load_dotenv()\n            json_schema_base64 = os.getenv(\"JSON_SCHEMA\")\n    \n            if json_schema_base64:\n                # Декодируем Base64\n                json_schema_str = base64.b64decode(json_schema_base64).decode(\"utf-8\")\n                # Загружаем в JSON\n                response_schema = json.loads(json_schema_str)\n            else:\n                raise ValueError(\"JSON_SCHEMA is not set\")\n                # print(json.dumps(response_schema, indent=4))\n    \n        with allure.step(\"Перехватываю запрос и ответ\"):\n            with (page_fixture.expect_response(os.getenv(\"METHOD\")) as response_info,\n                  page_fixture.expect_request(os.getenv(\"METHOD\")) as request_info):\n                checkout_page.calculation_block.click_order_button()\n    \n        time.sleep(5)\n        order_number = purchase_page.memorize_the_order_number()\n        print(order_number)\n        with allure.step(\"Проверяю, что номер заказа не пустой\"):\n            assert order_number != \"\", \"Номер заказа пустой!\"\n        with allure.step(\n                \"Проверяю, что номер заказа соответствует одному из шаблонов Х-000000000, ХX000000000, 000000000.\"):\n            pattern = r'^[А-Яа-я-]*\\d{9}[А-Яа-я-]*$'\n    \n            assert re.match(pattern, order_number), f\"Номер заказа '{order_number}' не соответствует шаблону Х-000000000!\"\n    \n        # with allure.step(\"Ожидаю номер заказа\"):\n        #     time.sleep(5)\n        #     order_number = purchase_page.memorize_the_order_number()\n        #     print(order_number)\n    \n        with allure.step(\"Извлекаю из ответа JSON\"):\n            response = response_info.value\n            response_body = response.json()\n    \n        with allure.step(\"Проверяю статус код ответа\"):\n            assert response.status == 200, f\"Ожидался статус 200, получен {response.status}\"\n    \n        with allure.step(\"Валидирую JSON-схему ответа\"):\n            try:\n                validate(instance=response_body, schema=response_schema)\n            except ValidationError as e:\n                pytest.fail(f\"SCHEMA VALIDATION FAILED:\\n\"\n                            f\"Field: {list(e.path)}\\n\"\n                            f\"Error: {e.message}\\n\"\n                            f\"Value: {e.instance}\")\n    \n        # Функция для экранирования кавычек\n        def escape_json_string(value):\n            with allure.step(\"Экранирует кавычки в строках для корректного JSON\"):\n                return json.dumps(value)[1:-1]  # убираем внешние кавычки, но экранируем внутри\n    \n        with allure.step(\"Загружаю JSON-схему с проверочными значениями\"):\n            json_schema_base64_test = os.getenv(\"JSON_SCHEMA_TEST\")\n    \n            if json_schema_base64_test:\n                # Декодируем Base64\n                json_schema_str_test = base64.b64decode(json_schema_base64_test).decode(\"utf-8\")\n                # Загружаем в JSON\n                schema_str = json.loads(json_schema_str_test)\n            else:\n                raise ValueError(\"JSON_SCHEMA_TEST is not set\")\n    \n            # Преобразуем JSON-объект обратно в строку перед replace\n            schema_str = json.dumps(schema_str)\n    \n        with allure.step(\"Заменяю переменные в схеме на реальные значения с экранированием\"):\n            schema_str = schema_str.replace(\"{company_name}\", escape_json_string(company_name))\n            schema_str = schema_str.replace(\"{name}\", escape_json_string(name))\n            schema_str = schema_str.replace(\"{email}\", escape_json_string(email))\n            schema_str = schema_str.replace(\"{phone}\", re.sub(r'\\D', '', phone))\n            with allure.step(\"Заменяю '{obtaining_block_adress}' на JSON-строку\"):\n                obtaining_block_adress_json = json.dumps(obtaining_block_adress)  # превращаем объект в строку JSON\n                schema_str = schema_str.replace(\"\\\"{obtaining_block_adress}\\\"\", obtaining_block_adress_json)\n    \n            with allure.step(\"Преобразую строку обратно в JSON.\"):\n                schema = json.loads(schema_str)\n    \n        def to_lower(obj):\n            \"\"\"Рекурсивно приводит все строки в JSON-объекте к нижнему регистру.\"\"\"\n            if isinstance(obj, dict):\n                return {k: to_lower(v) for k, v in obj.items()}\n            elif isinstance(obj, list):\n                return [to_lower(i) for i in obj]\n            elif isinstance(obj, str):\n                return obj.lower()\n            return obj\n    \n        with allure.step(\"Валидирую JSON-схему ответа\"):\n            try:\n                response_body_lower = to_lower(response_body)\n                schema_lower = to_lower(schema)\n>               validate(instance=response_body_lower, schema=schema_lower)\n\ntests/test_create_order.py:183: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ninstance = {'buyer': {'title': 'ооо \"тест\"'}, 'contact': {'email': 'ershovgerman@example.net', 'id': '4dfc16a1-7620-4bb6-9aa5-35e...ывывывывывывывывывывыывывывывывыываывывывывв\", 'phone': '79483095176'}, 'cost_center': None, 'courier_data': None, ...}\nschema = {'properties': {'buyer': {'properties': {'title': {'const': 'ооо \"тест\"', 'type': 'string'}}, 'required': ['title'], '...'null']}, ...}, 'required': ['id', 'seller', 'buyer', 'contact', 'pickup_data', 'courier_data', ...], 'type': 'object'}\ncls = <class 'jsonschema.validators.Draft202012Validator'>, args = ()\nkwargs = {}\nvalidator = Draft202012Validator(schema={'properties': {'buyer': {'properties': {'title': {'const': 'ооо \"тест\"', 'type': 'string'...red': ['id', 'seller', 'buyer', 'contact', 'pickup_data', 'courier_data', ...], 'type': 'object'}, format_checker=None)\nerror = <ValidationError: \"'400' was expected\">\n\n    def validate(instance, schema, cls=None, *args, **kwargs):  # noqa: D417\n        \"\"\"\n        Validate an instance under the given schema.\n    \n            >>> validate([2, 3, 4], {\"maxItems\": 2})\n            Traceback (most recent call last):\n                ...\n            ValidationError: [2, 3, 4] is too long\n    \n        :func:`~jsonschema.validators.validate` will first verify that the\n        provided schema is itself valid, since not doing so can lead to less\n        obvious error messages and fail in less obvious or consistent ways.\n    \n        If you know you have a valid schema already, especially\n        if you intend to validate multiple instances with\n        the same schema, you likely would prefer using the\n        `jsonschema.protocols.Validator.validate` method directly on a\n        specific validator (e.g. ``Draft202012Validator.validate``).\n    \n    \n        Arguments:\n    \n            instance:\n    \n                The instance to validate\n    \n            schema:\n    \n                The schema to validate with\n    \n            cls (jsonschema.protocols.Validator):\n    \n                The class that will be used to validate the instance.\n    \n        If the ``cls`` argument is not provided, two things will happen\n        in accordance with the specification. First, if the schema has a\n        :kw:`$schema` keyword containing a known meta-schema [#]_ then the\n        proper validator will be used. The specification recommends that\n        all schemas contain :kw:`$schema` properties for this reason. If no\n        :kw:`$schema` property is found, the default validator class is the\n        latest released draft.\n    \n        Any other provided positional and keyword arguments will be passed\n        on when instantiating the ``cls``.\n    \n        Raises:\n    \n            `jsonschema.exceptions.ValidationError`:\n    \n                if the instance is invalid\n    \n            `jsonschema.exceptions.SchemaError`:\n    \n                if the schema itself is invalid\n    \n        .. rubric:: Footnotes\n        .. [#] known by a validator registered with\n            `jsonschema.validators.validates`\n        \"\"\"\n        if cls is None:\n            cls = validator_for(schema)\n    \n        cls.check_schema(schema)\n        validator = cls(schema, *args, **kwargs)\n        error = exceptions.best_match(validator.iter_errors(instance))\n        if error is not None:\n>           raise error\nE           jsonschema.exceptions.ValidationError: '400' was expected\nE           \nE           Failed validating 'const' in schema['properties']['summary']['properties']['subtotal']:\nE               {'const': '400', 'type': 'string'}\nE           \nE           On instance['summary']['subtotal']:\nE               '500'\n\n/opt/hostedtoolcache/Python/3.12.1/x64/lib/python3.12/site-packages/jsonschema/validators.py:1312: ValidationError\n\nDuring handling of the above exception, another exception occurred:\n\npage_fixture = <Page url='https://garwin.ru/cabinet/purchase/977b3c81-d930-4814-9a7f-2c60e3beec4a'>\nbase_url = 'https://garwin.ru'\ndelete_recipient_fixture = <function delete_recipient_fixture.<locals>.mark_as_created at 0x7f456d3bb6a0>\ndelete_address_fixture = <function delete_address_fixture.<locals>.mark_as_created at 0x7f456d3bbec0>\n\n    @pytest.mark.auth\n    @pytest.mark.smoke\n    @pytest.mark.custom_schedule\n    @allure.title(\"Создание заказа с валидацией JSON-схемы\")\n    def test_create_order_schema(page_fixture, base_url, delete_recipient_fixture, delete_address_fixture):\n        cart_page = CartPage(page_fixture)\n        checkout_page = CheckoutPage(page_fixture)\n        purchase_page = PurchasePage(page_fixture)\n        header = HeaderElement(page_fixture)\n        companies_page = CompaniesPage(page_fixture)\n        companies_page.select_company_with_retail_price(base_url)\n        cart_page.open(base_url)\n    \n        with allure.step(\"Запоминаю адрес в блоке Получение\"):\n            company_name = header.company_name_text()\n    \n        cart_page.clear_cart()\n        cart_page.add_to_cart_cheap_product(base_url)\n    \n        name, email, phone = checkout_page.buyer_and_recipient_block.create_recipient(base_url, page_fixture)\n        checkout_page.obtaining_block.create_address(base_url, page_fixture)\n    \n        delete_recipient_fixture()\n        delete_address_fixture()\n    \n        with allure.step(\"Добавляею комментарий к заказу\"):\n            checkout_page.payment_block.click_contact_a_manager_button()\n            checkout_page.commentary_block.click_commentary_togle_button()\n            checkout_page.commentary_block.fill_commentary_textarea(\"!!! TEST !!!\")\n    \n        with allure.step(\"Запоминаю адрес в блоке Получение\"):\n            obtaining_block_adress = checkout_page.obtaining_block.pickup_point_adress().inner_text()\n    \n        with allure.step(\"Загружаю JSON-схему\"):\n    \n            load_dotenv()\n            json_schema_base64 = os.getenv(\"JSON_SCHEMA\")\n    \n            if json_schema_base64:\n                # Декодируем Base64\n                json_schema_str = base64.b64decode(json_schema_base64).decode(\"utf-8\")\n                # Загружаем в JSON\n                response_schema = json.loads(json_schema_str)\n            else:\n                raise ValueError(\"JSON_SCHEMA is not set\")\n                # print(json.dumps(response_schema, indent=4))\n    \n        with allure.step(\"Перехватываю запрос и ответ\"):\n            with (page_fixture.expect_response(os.getenv(\"METHOD\")) as response_info,\n                  page_fixture.expect_request(os.getenv(\"METHOD\")) as request_info):\n                checkout_page.calculation_block.click_order_button()\n    \n        time.sleep(5)\n        order_number = purchase_page.memorize_the_order_number()\n        print(order_number)\n        with allure.step(\"Проверяю, что номер заказа не пустой\"):\n            assert order_number != \"\", \"Номер заказа пустой!\"\n        with allure.step(\n                \"Проверяю, что номер заказа соответствует одному из шаблонов Х-000000000, ХX000000000, 000000000.\"):\n            pattern = r'^[А-Яа-я-]*\\d{9}[А-Яа-я-]*$'\n    \n            assert re.match(pattern, order_number), f\"Номер заказа '{order_number}' не соответствует шаблону Х-000000000!\"\n    \n        # with allure.step(\"Ожидаю номер заказа\"):\n        #     time.sleep(5)\n        #     order_number = purchase_page.memorize_the_order_number()\n        #     print(order_number)\n    \n        with allure.step(\"Извлекаю из ответа JSON\"):\n            response = response_info.value\n            response_body = response.json()\n    \n        with allure.step(\"Проверяю статус код ответа\"):\n            assert response.status == 200, f\"Ожидался статус 200, получен {response.status}\"\n    \n        with allure.step(\"Валидирую JSON-схему ответа\"):\n            try:\n                validate(instance=response_body, schema=response_schema)\n            except ValidationError as e:\n                pytest.fail(f\"SCHEMA VALIDATION FAILED:\\n\"\n                            f\"Field: {list(e.path)}\\n\"\n                            f\"Error: {e.message}\\n\"\n                            f\"Value: {e.instance}\")\n    \n        # Функция для экранирования кавычек\n        def escape_json_string(value):\n            with allure.step(\"Экранирует кавычки в строках для корректного JSON\"):\n                return json.dumps(value)[1:-1]  # убираем внешние кавычки, но экранируем внутри\n    \n        with allure.step(\"Загружаю JSON-схему с проверочными значениями\"):\n            json_schema_base64_test = os.getenv(\"JSON_SCHEMA_TEST\")\n    \n            if json_schema_base64_test:\n                # Декодируем Base64\n                json_schema_str_test = base64.b64decode(json_schema_base64_test).decode(\"utf-8\")\n                # Загружаем в JSON\n                schema_str = json.loads(json_schema_str_test)\n            else:\n                raise ValueError(\"JSON_SCHEMA_TEST is not set\")\n    \n            # Преобразуем JSON-объект обратно в строку перед replace\n            schema_str = json.dumps(schema_str)\n    \n        with allure.step(\"Заменяю переменные в схеме на реальные значения с экранированием\"):\n            schema_str = schema_str.replace(\"{company_name}\", escape_json_string(company_name))\n            schema_str = schema_str.replace(\"{name}\", escape_json_string(name))\n            schema_str = schema_str.replace(\"{email}\", escape_json_string(email))\n            schema_str = schema_str.replace(\"{phone}\", re.sub(r'\\D', '', phone))\n            with allure.step(\"Заменяю '{obtaining_block_adress}' на JSON-строку\"):\n                obtaining_block_adress_json = json.dumps(obtaining_block_adress)  # превращаем объект в строку JSON\n                schema_str = schema_str.replace(\"\\\"{obtaining_block_adress}\\\"\", obtaining_block_adress_json)\n    \n            with allure.step(\"Преобразую строку обратно в JSON.\"):\n                schema = json.loads(schema_str)\n    \n        def to_lower(obj):\n            \"\"\"Рекурсивно приводит все строки в JSON-объекте к нижнему регистру.\"\"\"\n            if isinstance(obj, dict):\n                return {k: to_lower(v) for k, v in obj.items()}\n            elif isinstance(obj, list):\n                return [to_lower(i) for i in obj]\n            elif isinstance(obj, str):\n                return obj.lower()\n            return obj\n    \n        with allure.step(\"Валидирую JSON-схему ответа\"):\n            try:\n                response_body_lower = to_lower(response_body)\n                schema_lower = to_lower(schema)\n                validate(instance=response_body_lower, schema=schema_lower)\n            except ValidationError as e:\n>               pytest.fail(f\"SCHEMA VALIDATION FAILED:\\n\"\n                            f\"Field: {list(e.path)}\\n\"\n                            f\"Error: {e.message}\\n\"\n                            f\"Value: {e.instance}\")\nE               Failed: SCHEMA VALIDATION FAILED:\nE               Field: ['summary', 'subtotal']\nE               Error: '400' was expected\nE               Value: 500\n\ntests/test_create_order.py:185: Failed","steps":[{"name":"Выбираю контрагента с розничным типом цен","time":{"start":1749964793998,"stop":1749964797961,"duration":3963},"status":"passed","steps":[{"name":"Открываю страницу Мои компании","time":{"start":1749964793998,"stop":1749964797891,"duration":3893},"status":"passed","steps":[{"name":"Открываю https://garwin.ru/cabinet/companies/","time":{"start":1749964793998,"stop":1749964797891,"duration":3893},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"url","value":"'https://garwin.ru'"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Нахожу компанию с не розничным типом цен","time":{"start":1749964797891,"stop":1749964797925,"duration":34},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Проверяю состояние кнопки и выбираю компанию, если она не выбрана","time":{"start":1749964797925,"stop":1749964797961,"duration":36},"status":"passed","steps":[],"attachments":[{"uid":"839686ecfcf53043","name":"Состояние кнопки","source":"839686ecfcf53043.attach","type":"text/plain","size":39}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"base_url","value":"'https://garwin.ru'"}],"shouldDisplayMessage":false,"stepsCount":4,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},{"name":"Открываю https://garwin.ru/cart","time":{"start":1749964797961,"stop":1749964801029,"duration":3068},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Запоминаю адрес в блоке Получение","time":{"start":1749964801029,"stop":1749964801062,"duration":33},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Очищаю корзину","time":{"start":1749964801062,"stop":1749964801081,"duration":19},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Добавляю дешевый товар в корзину","time":{"start":1749964801081,"stop":1749964878094,"duration":77013},"status":"passed","steps":[],"attachments":[],"parameters":[{"name":"url","value":"'https://garwin.ru'"}],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Создаю нового получателя","time":{"start":1749964878094,"stop":1749964894342,"duration":16248},"status":"passed","steps":[{"name":"Открываю https://garwin.ru/checkout","time":{"start":1749964878094,"stop":1749964880089,"duration":1995},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Открываю листинг получателей","time":{"start":1749964880089,"stop":1749964883103,"duration":3014},"status":"broken","statusMessage":"playwright._impl._errors.TimeoutError: Timeout 3000ms exceeded.\n","statusTrace":"  File \"/opt/hostedtoolcache/Python/3.12.1/x64/lib/python3.12/site-packages/allure_commons/_allure.py\", line 192, in impl\n    return func(*a, **kw)\n           ^^^^^^^^^^^^^^\n  File \"/home/runner/work/playwright_tests_UI/playwright_tests_UI/page_objects/checkout_page.py\", line 237, in open_recipient_listing\n    self.page.locator(self.buyer_and_recipient_block.RECIPIENT_CHANGE_BUTTON).wait_for(timeout=3000)\n  File \"/opt/hostedtoolcache/Python/3.12.1/x64/lib/python3.12/site-packages/playwright/sync_api/_generated.py\", line 18419, in wait_for\n    self._sync(self._impl_obj.wait_for(timeout=timeout, state=state))\n  File \"/opt/hostedtoolcache/Python/3.12.1/x64/lib/python3.12/site-packages/playwright/_impl/_sync_base.py\", line 115, in _sync\n    return task.result()\n           ^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.12.1/x64/lib/python3.12/site-packages/playwright/_impl/_locator.py\", line 668, in wait_for\n    await self._frame.wait_for_selector(\n  File \"/opt/hostedtoolcache/Python/3.12.1/x64/lib/python3.12/site-packages/playwright/_impl/_frame.py\", line 327, in wait_for_selector\n    await self._channel.send(\"waitForSelector\", locals_to_params(locals()))\n  File \"/opt/hostedtoolcache/Python/3.12.1/x64/lib/python3.12/site-packages/playwright/_impl/_connection.py\", line 63, in send\n    return await self._connection.wrap_api_call(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.12.1/x64/lib/python3.12/site-packages/playwright/_impl/_connection.py\", line 495, in wrap_api_call\n    return await cb()\n           ^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.12.1/x64/lib/python3.12/site-packages/playwright/_impl/_connection.py\", line 101, in inner_send\n    result = next(iter(done)).result()\n             ^^^^^^^^^^^^^^^^^^^^^^^^^\n","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Открываю окно Нового получателя","time":{"start":1749964883103,"stop":1749964884193,"duration":1090},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Открываю окно Новый получатель","time":{"start":1749964884193,"stop":1749964885298,"duration":1105},"status":"passed","steps":[{"name":"Проверяю, что модальное окно нового получателя открыто","time":{"start":1749964885275,"stop":1749964885298,"duration":23},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Ввожу текст в котором включены все допустимые буквы и символы, их максимальное количество","time":{"start":1749964885298,"stop":1749964888435,"duration":3137},"status":"passed","steps":[{"name":"Заполняю поля сгенерированными данными","time":{"start":1749964885298,"stop":1749964888435,"duration":3137},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Нажимаю на кнопку Сохранить","time":{"start":1749964888435,"stop":1749964889537,"duration":1102},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Формирую ожидаемый текст","time":{"start":1749964889537,"stop":1749964889537,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Проверяю текст в блоке получателя","time":{"start":1749964889537,"stop":1749964889550,"duration":13},"status":"passed","steps":[],"attachments":[],"parameters":[{"name":"expected_info","value":"'згрЫвыв wdSdsdsdsd-вавава вававава'ывыывывывывывывывывывывывывывывыывывывывывыываывывывывв, ershovgerman@example.net, +7 (948) 309-51-76'"}],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Открываю листинг получателей","time":{"start":1749964889551,"stop":1749964893172,"duration":3621},"status":"passed","steps":[{"name":"Открываю https://garwin.ru/checkout","time":{"start":1749964889551,"stop":1749964891957,"duration":2406},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Открываю листинг получателей","time":{"start":1749964891957,"stop":1749964893172,"duration":1215},"status":"passed","steps":[{"name":"Проверяю, что листинг пользователей открыт","time":{"start":1749964893146,"stop":1749964893172,"duration":26},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"base_url","value":"'https://garwin.ru'"},{"name":"page_fixture","value":"<Page url='https://garwin.ru/checkout'>"}],"shouldDisplayMessage":false,"stepsCount":3,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Формирую ожидаемый текст","time":{"start":1749964893172,"stop":1749964893172,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Проверяю информацию о выбранном получателе","time":{"start":1749964893172,"stop":1749964894342,"duration":1170},"status":"passed","steps":[{"name":"Проверяю, что новый получатель появился в листинге, его информация соответствует заданной, он активен","time":{"start":1749964893172,"stop":1749964893246,"duration":74},"status":"passed","steps":[{"name":"Нахожу блок с активной радиокнопкой","time":{"start":1749964893172,"stop":1749964893197,"duration":25},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Ищу информацию в выбранном блоке","time":{"start":1749964893197,"stop":1749964893246,"duration":49},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Сравниваю с ожидаемыми значениями","time":{"start":1749964893246,"stop":1749964893246,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"expected_title","value":"'згрЫвыв wdSdsdsdsd-вавава вававава'ывыывывывывывывывывывывывывывывыывывывывывыываывывывывв'"},{"name":"expected_description","value":"'ershovgerman@example.net, +7 (948) 309-51-76'"}],"shouldDisplayMessage":false,"stepsCount":3,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Закрываю листинг получателей","time":{"start":1749964893246,"stop":1749964894342,"duration":1096},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":5,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"base_url","value":"'https://garwin.ru'"},{"name":"page_fixture","value":"<Page url='https://garwin.ru/tovar/sverlo-po-metallu-ts-hv-0-8-shlif-118'>"}],"shouldDisplayMessage":false,"stepsCount":21,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Создаю новый адрес","time":{"start":1749964894342,"stop":1749964903242,"duration":8900},"status":"passed","steps":[{"name":"Открываю https://garwin.ru/checkout","time":{"start":1749964894342,"stop":1749964896752,"duration":2410},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Открываю листинг адресов","time":{"start":1749964896753,"stop":1749964899763,"duration":3010},"status":"broken","statusMessage":"playwright._impl._errors.TimeoutError: Timeout 3000ms exceeded.\n","statusTrace":"  File \"/opt/hostedtoolcache/Python/3.12.1/x64/lib/python3.12/site-packages/allure_commons/_allure.py\", line 192, in impl\n    return func(*a, **kw)\n           ^^^^^^^^^^^^^^\n  File \"/home/runner/work/playwright_tests_UI/playwright_tests_UI/page_objects/checkout_page.py\", line 847, in adress_listing_activation\n    self.page.locator(self.CHANGE_BUTTON).wait_for(timeout=3000)\n  File \"/opt/hostedtoolcache/Python/3.12.1/x64/lib/python3.12/site-packages/playwright/sync_api/_generated.py\", line 18419, in wait_for\n    self._sync(self._impl_obj.wait_for(timeout=timeout, state=state))\n  File \"/opt/hostedtoolcache/Python/3.12.1/x64/lib/python3.12/site-packages/playwright/_impl/_sync_base.py\", line 115, in _sync\n    return task.result()\n           ^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.12.1/x64/lib/python3.12/site-packages/playwright/_impl/_locator.py\", line 668, in wait_for\n    await self._frame.wait_for_selector(\n  File \"/opt/hostedtoolcache/Python/3.12.1/x64/lib/python3.12/site-packages/playwright/_impl/_frame.py\", line 327, in wait_for_selector\n    await self._channel.send(\"waitForSelector\", locals_to_params(locals()))\n  File \"/opt/hostedtoolcache/Python/3.12.1/x64/lib/python3.12/site-packages/playwright/_impl/_connection.py\", line 63, in send\n    return await self._connection.wrap_api_call(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.12.1/x64/lib/python3.12/site-packages/playwright/_impl/_connection.py\", line 495, in wrap_api_call\n    return await cb()\n           ^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.12.1/x64/lib/python3.12/site-packages/playwright/_impl/_connection.py\", line 101, in inner_send\n    result = next(iter(done)).result()\n             ^^^^^^^^^^^^^^^^^^^^^^^^^\n","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Нажимаю на Выберите способ и адрес получения","time":{"start":1749964899763,"stop":1749964900873,"duration":1110},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Открываю модалку Карты","time":{"start":1749964900873,"stop":1749964901992,"duration":1119},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Выбираю ПВЗ по кастомному событию","time":{"start":1749964901992,"stop":1749964902011,"duration":19},"status":"passed","steps":[],"attachments":[],"parameters":[{"name":"pickup_point_id","value":"'84ac7315-76f0-4506-8f69-6f28f6d249c6'"},{"name":"latitude","value":"59.941833"},{"name":"longitude","value":"30.189611"}],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Подтверждаю выбор ПВЗ","time":{"start":1749964902011,"stop":1749964903242,"duration":1231},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"base_url","value":"'https://garwin.ru'"},{"name":"page_fixture","value":"<Page url='https://garwin.ru/checkout'>"}],"shouldDisplayMessage":false,"stepsCount":6,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Добавляею комментарий к заказу","time":{"start":1749964903242,"stop":1749964906347,"duration":3105},"status":"passed","steps":[{"name":"Нажимаю на кнопку Уточнить у менеджера","time":{"start":1749964903242,"stop":1749964904281,"duration":1039},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Нажимаю на кнопку Комментарий к заказу","time":{"start":1749964904281,"stop":1749964905316,"duration":1035},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Ввожу значение в поле Комментарий","time":{"start":1749964905316,"stop":1749964906347,"duration":1031},"status":"passed","steps":[],"attachments":[],"parameters":[{"name":"text","value":"'!!! TEST !!!'"}],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":3,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Запоминаю адрес в блоке Получение","time":{"start":1749964906347,"stop":1749964906363,"duration":16},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Загружаю JSON-схему","time":{"start":1749964906363,"stop":1749964906363,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Перехватываю запрос и ответ","time":{"start":1749964906363,"stop":1749964907470,"duration":1107},"status":"passed","steps":[{"name":"Нажимаю на кнопку 'Оформить заказ'","time":{"start":1749964906382,"stop":1749964907470,"duration":1088},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Извлекаю номер заказа","time":{"start":1749964912472,"stop":1749964912529,"duration":57},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Проверяю, что номер заказа не пустой","time":{"start":1749964912529,"stop":1749964912529,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Проверяю, что номер заказа соответствует одному из шаблонов Х-000000000, ХX000000000, 000000000.","time":{"start":1749964912529,"stop":1749964912529,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Извлекаю из ответа JSON","time":{"start":1749964912529,"stop":1749964912532,"duration":3},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Проверяю статус код ответа","time":{"start":1749964912532,"stop":1749964912532,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Валидирую JSON-схему ответа","time":{"start":1749964912532,"stop":1749964912565,"duration":33},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Загружаю JSON-схему с проверочными значениями","time":{"start":1749964912565,"stop":1749964912566,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Заменяю переменные в схеме на реальные значения с экранированием","time":{"start":1749964912566,"stop":1749964912566,"duration":0},"status":"passed","steps":[{"name":"Экранирует кавычки в строках для корректного JSON","time":{"start":1749964912566,"stop":1749964912566,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Экранирует кавычки в строках для корректного JSON","time":{"start":1749964912566,"stop":1749964912566,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Экранирует кавычки в строках для корректного JSON","time":{"start":1749964912566,"stop":1749964912566,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Заменяю '{obtaining_block_adress}' на JSON-строку","time":{"start":1749964912566,"stop":1749964912566,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Преобразую строку обратно в JSON.","time":{"start":1749964912566,"stop":1749964912566,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":5,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Валидирую JSON-схему ответа","time":{"start":1749964912566,"stop":1749964912597,"duration":31},"status":"failed","statusMessage":"Failed: SCHEMA VALIDATION FAILED:\nField: ['summary', 'subtotal']\nError: '400' was expected\nValue: 500\n","statusTrace":"  File \"/home/runner/work/playwright_tests_UI/playwright_tests_UI/tests/test_create_order.py\", line 185, in test_create_order_schema\n    pytest.fail(f\"SCHEMA VALIDATION FAILED:\\n\"\n  File \"/opt/hostedtoolcache/Python/3.12.1/x64/lib/python3.12/site-packages/_pytest/outcomes.py\", line 187, in fail\n    raise Failed(msg=reason, pytrace=pytrace)\n","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":60,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"delete_address_fixture::teardown","time":{"start":1749964912619,"stop":1749964914864,"duration":2245},"status":"broken","statusMessage":"ValueError: could not convert string to float: ''\n","statusTrace":"  File \"/opt/hostedtoolcache/Python/3.12.1/x64/lib/python3.12/site-packages/allure_commons/_allure.py\", line 221, in __call__\n    return self._fixture_function(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/playwright_tests_UI/playwright_tests_UI/conftest.py\", line 305, in teardown\n    price = checkout_page.calculation_block.total_price_value()\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.12.1/x64/lib/python3.12/site-packages/allure_commons/_allure.py\", line 192, in impl\n    return func(*a, **kw)\n           ^^^^^^^^^^^^^^\n  File \"/home/runner/work/playwright_tests_UI/playwright_tests_UI/page_objects/checkout_page.py\", line 1389, in total_price_value\n    total_price_number = float(text_total_price.replace('\\n\\n\\xa0\\n\\n₽', '').replace(',', '.').replace(' ₽', '')\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n","steps":[{"name":"Удаляю созданный адрес","time":{"start":1749964912619,"stop":1749964914864,"duration":2245},"status":"broken","statusMessage":"ValueError: could not convert string to float: ''\n","statusTrace":"  File \"/home/runner/work/playwright_tests_UI/playwright_tests_UI/conftest.py\", line 305, in teardown\n    price = checkout_page.calculation_block.total_price_value()\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.12.1/x64/lib/python3.12/site-packages/allure_commons/_allure.py\", line 192, in impl\n    return func(*a, **kw)\n           ^^^^^^^^^^^^^^\n  File \"/home/runner/work/playwright_tests_UI/playwright_tests_UI/page_objects/checkout_page.py\", line 1389, in total_price_value\n    total_price_number = float(text_total_price.replace('\\n\\n\\xa0\\n\\n₽', '').replace(',', '.').replace(' ₽', '')\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n","steps":[{"name":"Открываю https://garwin.ru/checkout","time":{"start":1749964912619,"stop":1749964914826,"duration":2207},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Читаю сумму в блоке Калькуляция","time":{"start":1749964914851,"stop":1749964914864,"duration":13},"status":"broken","statusMessage":"ValueError: could not convert string to float: ''\n","statusTrace":"  File \"/opt/hostedtoolcache/Python/3.12.1/x64/lib/python3.12/site-packages/allure_commons/_allure.py\", line 192, in impl\n    return func(*a, **kw)\n           ^^^^^^^^^^^^^^\n  File \"/home/runner/work/playwright_tests_UI/playwright_tests_UI/page_objects/checkout_page.py\", line 1389, in total_price_value\n    total_price_number = float(text_total_price.replace('\\n\\n\\xa0\\n\\n₽', '').replace(',', '.').replace(' ₽', '')\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n","steps":[{"name":"Извлекаю текст итоговой суммы в блоке Калькуляция","time":{"start":1749964914851,"stop":1749964914863,"duration":12},"status":"broken","statusMessage":"ValueError: could not convert string to float: ''\n","statusTrace":"  File \"/home/runner/work/playwright_tests_UI/playwright_tests_UI/page_objects/checkout_page.py\", line 1389, in total_price_value\n    total_price_number = float(text_total_price.replace('\\n\\n\\xa0\\n\\n₽', '').replace(',', '.').replace(' ₽', '')\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":3,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":4,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"delete_recipient_fixture::teardown","time":{"start":1749964914865,"stop":1749964917065,"duration":2200},"status":"broken","statusMessage":"ValueError: could not convert string to float: ''\n","statusTrace":"  File \"/opt/hostedtoolcache/Python/3.12.1/x64/lib/python3.12/site-packages/allure_commons/_allure.py\", line 221, in __call__\n    return self._fixture_function(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/playwright_tests_UI/playwright_tests_UI/conftest.py\", line 256, in teardown\n    price = checkout_page.calculation_block.total_price_value()\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.12.1/x64/lib/python3.12/site-packages/allure_commons/_allure.py\", line 192, in impl\n    return func(*a, **kw)\n           ^^^^^^^^^^^^^^\n  File \"/home/runner/work/playwright_tests_UI/playwright_tests_UI/page_objects/checkout_page.py\", line 1389, in total_price_value\n    total_price_number = float(text_total_price.replace('\\n\\n\\xa0\\n\\n₽', '').replace(',', '.').replace(' ₽', '')\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n","steps":[{"name":"Удаляю созданного получателя","time":{"start":1749964914865,"stop":1749964917065,"duration":2200},"status":"broken","statusMessage":"ValueError: could not convert string to float: ''\n","statusTrace":"  File \"/home/runner/work/playwright_tests_UI/playwright_tests_UI/conftest.py\", line 256, in teardown\n    price = checkout_page.calculation_block.total_price_value()\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.12.1/x64/lib/python3.12/site-packages/allure_commons/_allure.py\", line 192, in impl\n    return func(*a, **kw)\n           ^^^^^^^^^^^^^^\n  File \"/home/runner/work/playwright_tests_UI/playwright_tests_UI/page_objects/checkout_page.py\", line 1389, in total_price_value\n    total_price_number = float(text_total_price.replace('\\n\\n\\xa0\\n\\n₽', '').replace(',', '.').replace(' ₽', '')\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n","steps":[{"name":"Открываю https://garwin.ru/checkout","time":{"start":1749964914865,"stop":1749964917022,"duration":2157},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Читаю сумму в блоке Калькуляция","time":{"start":1749964917052,"stop":1749964917065,"duration":13},"status":"broken","statusMessage":"ValueError: could not convert string to float: ''\n","statusTrace":"  File \"/opt/hostedtoolcache/Python/3.12.1/x64/lib/python3.12/site-packages/allure_commons/_allure.py\", line 192, in impl\n    return func(*a, **kw)\n           ^^^^^^^^^^^^^^\n  File \"/home/runner/work/playwright_tests_UI/playwright_tests_UI/page_objects/checkout_page.py\", line 1389, in total_price_value\n    total_price_number = float(text_total_price.replace('\\n\\n\\xa0\\n\\n₽', '').replace(',', '.').replace(' ₽', '')\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n","steps":[{"name":"Извлекаю текст итоговой суммы в блоке Калькуляция","time":{"start":1749964917052,"stop":1749964917065,"duration":13},"status":"broken","statusMessage":"ValueError: could not convert string to float: ''\n","statusTrace":"  File \"/home/runner/work/playwright_tests_UI/playwright_tests_UI/page_objects/checkout_page.py\", line 1389, in total_price_value\n    total_price_number = float(text_total_price.replace('\\n\\n\\xa0\\n\\n₽', '').replace(',', '.').replace(' ₽', '')\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":3,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":4,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"page_fixture::0","time":{"start":1749964917066,"stop":1749964917876,"duration":810},"status":"passed","steps":[],"attachments":[{"uid":"46e7b45b15c03ac","name":"trace","source":"46e7b45b15c03ac.zip","type":"application/zip","size":8687660},{"uid":"7a3c9ae5abec5126","name":"failure_screenshot","source":"7a3c9ae5abec5126.png","type":"image/png","size":202706},{"uid":"6fddd599f3665cbc","name":"page_source","source":"6fddd599f3665cbc.html","type":"text/html","size":689135},{"uid":"b8510a932016a05a","name":"network_logs","source":"b8510a932016a05a.json","type":"application/json","size":2}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":4,"hasContent":true,"attachmentStep":false},{"name":"browser::0","time":{"start":1749964917877,"stop":1749964917936,"duration":59},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"playwright::0","time":{"start":1749964917938,"stop":1749964917946,"duration":8},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"tag","value":"custom_schedule"},{"name":"tag","value":"smoke"},{"name":"tag","value":"auth"},{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_create_order"},{"name":"host","value":"pkrvmfw4aktn2gb"},{"name":"thread","value":"4320-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_create_order"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"browser_name","value":"'chromium'"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[{"uid":"ff24f04c3db0ba36","status":"failed","statusDetails":"Failed: SCHEMA VALIDATION FAILED:\nField: ['summary', 'subtotal']\nError: '400' was expected\nValue: 500","time":{"start":1749964666549,"stop":1749964785439,"duration":118890}},{"uid":"5027f117ab6bd41f","status":"failed","statusDetails":"Failed: SCHEMA VALIDATION FAILED:\nField: ['summary', 'subtotal']\nError: '400' was expected\nValue: 500","time":{"start":1749964541672,"stop":1749964658034,"duration":116362}}],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":1,"broken":0,"skipped":0,"passed":27,"unknown":0,"total":28},"items":[{"uid":"94f6de05abc026f8","reportUrl":"https://garagetools-garwin.github.io/playwright_tests_UI/345//#testresult/94f6de05abc026f8","status":"passed","time":{"start":1749878209293,"stop":1749878260023,"duration":50730}},{"uid":"3a084eab25927277","reportUrl":"https://garagetools-garwin.github.io/playwright_tests_UI/343//#testresult/3a084eab25927277","status":"passed","time":{"start":1749794518875,"stop":1749794563961,"duration":45086}},{"uid":"86c195883df3809f","reportUrl":"https://garagetools-garwin.github.io/playwright_tests_UI/341//#testresult/86c195883df3809f","status":"passed","time":{"start":1749708239741,"stop":1749708290307,"duration":50566}},{"uid":"616afb6bda19fc82","reportUrl":"https://garagetools-garwin.github.io/playwright_tests_UI/339//#testresult/616afb6bda19fc82","status":"passed","time":{"start":1749619086533,"stop":1749619140355,"duration":53822}},{"uid":"5ad7fbd9b642a37c","reportUrl":"https://garagetools-garwin.github.io/playwright_tests_UI/337//#testresult/5ad7fbd9b642a37c","status":"passed","time":{"start":1749535490961,"stop":1749535536096,"duration":45135}},{"uid":"42e1fbd5e89b7c09","reportUrl":"https://garagetools-garwin.github.io/playwright_tests_UI/335//#testresult/42e1fbd5e89b7c09","status":"passed","time":{"start":1749449046180,"stop":1749449091837,"duration":45657}},{"uid":"668e3c3c0a835132","reportUrl":"https://garagetools-garwin.github.io/playwright_tests_UI/333//#testresult/668e3c3c0a835132","status":"passed","time":{"start":1749359828901,"stop":1749359874841,"duration":45940}},{"uid":"545151c66a3c49e3","reportUrl":"https://garagetools-garwin.github.io/playwright_tests_UI/331//#testresult/545151c66a3c49e3","status":"passed","time":{"start":1749273347167,"stop":1749273395640,"duration":48473}},{"uid":"560191e4dddacb0f","reportUrl":"https://garagetools-garwin.github.io/playwright_tests_UI/329//#testresult/560191e4dddacb0f","status":"passed","time":{"start":1749187034045,"stop":1749187079954,"duration":45909}},{"uid":"b4cf21fcd05c51a2","reportUrl":"https://garagetools-garwin.github.io/playwright_tests_UI/327//#testresult/b4cf21fcd05c51a2","status":"passed","time":{"start":1749100641996,"stop":1749100688518,"duration":46522}},{"uid":"e33660d210c08363","reportUrl":"https://garagetools-garwin.github.io/playwright_tests_UI/325//#testresult/e33660d210c08363","status":"passed","time":{"start":1749017524796,"stop":1749017571484,"duration":46688}},{"uid":"3a72831ee4a629b9","reportUrl":"https://garagetools-garwin.github.io/playwright_tests_UI/323//#testresult/3a72831ee4a629b9","status":"passed","time":{"start":1748927845938,"stop":1748927890740,"duration":44802}},{"uid":"4a5a219634f6fe69","reportUrl":"https://garagetools-garwin.github.io/playwright_tests_UI/321//#testresult/4a5a219634f6fe69","status":"passed","time":{"start":1748841478572,"stop":1748841525864,"duration":47292}},{"uid":"418925615e05d2e5","reportUrl":"https://garagetools-garwin.github.io/playwright_tests_UI/319//#testresult/418925615e05d2e5","status":"passed","time":{"start":1748757744321,"stop":1748757789846,"duration":45525}},{"uid":"69cbea6aba6466f8","reportUrl":"https://garagetools-garwin.github.io/playwright_tests_UI/317//#testresult/69cbea6aba6466f8","status":"passed","time":{"start":1748672790895,"stop":1748672843858,"duration":52963}},{"uid":"aa9de77e73d8c672","reportUrl":"https://garagetools-garwin.github.io/playwright_tests_UI/315//#testresult/aa9de77e73d8c672","status":"passed","time":{"start":1748584967759,"stop":1748585016055,"duration":48296}},{"uid":"c3d39e3e5a622ae4","reportUrl":"https://garagetools-garwin.github.io/playwright_tests_UI/313//#testresult/c3d39e3e5a622ae4","status":"passed","time":{"start":1748495847132,"stop":1748495894017,"duration":46885}},{"uid":"fb86c5dd5200b556","reportUrl":"https://garagetools-garwin.github.io/playwright_tests_UI/311//#testresult/fb86c5dd5200b556","status":"passed","time":{"start":1748412267416,"stop":1748412312809,"duration":45393}},{"uid":"8688a9b2160196c4","reportUrl":"https://garagetools-garwin.github.io/playwright_tests_UI/309//#testresult/8688a9b2160196c4","status":"passed","time":{"start":1748330228590,"stop":1748330282312,"duration":53722}},{"uid":"6d9b46a8c3c52eb7","reportUrl":"https://garagetools-garwin.github.io/playwright_tests_UI/308//#testresult/6d9b46a8c3c52eb7","status":"passed","time":{"start":1748326096932,"stop":1748326144095,"duration":47163}}]},"tags":["auth","smoke","custom_schedule"]},"source":"9f67aad77d166bd1.json","parameterValues":["'chromium'"]}